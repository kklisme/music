{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { logout } from \"../../../../network/login/login\";\nimport { getUserDetail } from \"../../../../network/userdetail/userdetail\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  name: \"UserPop\",\n  computed: {\n    ...mapGetters([\"userInfo\"])\n  },\n  created() {\n    this.getUserDetailBy();\n  },\n  methods: {\n    //获取用户个人信息\n    getUserDetailBy() {\n      getUserDetail(this.userInfo.userId).then(res => {\n        this.setItem(\"userInfo\", res.data.profile);\n        // 提交vuex 保存用户信息\n        this.$store.dispatch(\"saveUserInfo\", res.data.profile);\n      });\n    },\n    // 点击个人主页\n    toMyhome() {\n      this.$router.push(\"/userdetail/\" + this.userInfo.userId);\n    },\n    // 点击听歌排行去往用户播放记录页面\n    getUserRecordBy() {\n      this.$router.push(\"/userdetail/record/\" + this.userInfo.userId);\n    },\n    //点击关注去往关注列表\n    toFollows() {\n      this.$router.push({\n        name: \"Follows\",\n        params: {\n          uid: this.userInfo.userId,\n          uname: this.userInfo.nickname,\n          follows: this.userInfo.follows\n        }\n      });\n    },\n    //点击粉丝去往粉丝列表\n    toFansList() {\n      this.$router.push({\n        name: \"FansList\",\n        params: {\n          uid: this.userInfo.userId,\n          uname: this.userInfo.nickname\n        }\n      });\n    },\n    // 退出登录\n    logout() {\n      this.$confirm(\"您确定退出登录吗?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        logout().then(res => {\n          this.$message({\n            showClose: true,\n            message: \"退出成功\",\n            type: \"success\",\n            center: true\n          });\n          // 更新登录状态\n          this.$store.dispatch(\"updateLogin\", false);\n          this.removeItem(\"isLogin\");\n          // 清空用户信息\n          this.$store.dispatch(\"saveUserInfo\", null);\n          this.removeItem(\"userInfo\");\n          // 清空歌单\n          this.$store.dispatch(\"saveUserSongList\", []);\n          this.removeItem(\"userSongList\");\n          // 清空用户喜欢的音乐id列表\n          this.$store.dispatch(\"saveLikeSongIds\", []);\n          this.removeItem(\"likeSongIds\");\n          console.log(res);\n        });\n      }).catch(err => {\n        err;\n      });\n    }\n  },\n  mounted() {\n    // 点击其他区域关闭弹框\n    document.addEventListener(\"mouseup\", e => {\n      let showuserpop = document.querySelector(\"#showuserpop\");\n      if (showuserpop) {\n        if (!showuserpop.contains(e.target)) {\n          this.$emit(\"closeuserPop\");\n        }\n      }\n    });\n  }\n};","map":{"version":3,"names":["logout","getUserDetail","mapGetters","name","computed","created","getUserDetailBy","methods","userInfo","userId","then","res","setItem","data","profile","$store","dispatch","toMyhome","$router","push","getUserRecordBy","toFollows","params","uid","uname","nickname","follows","toFansList","$confirm","confirmButtonText","cancelButtonText","type","$message","showClose","message","center","removeItem","console","log","catch","err","mounted","document","addEventListener","e","showuserpop","querySelector","contains","target","$emit"],"sources":["src/components/content/login/UserPop.vue"],"sourcesContent":["<template>\n\t<div>\n\t\t<div class=\"user-pop\" ref=\"userpop\">\n\t\t\t<div class=\"data-num\">\n\t\t\t\t<div class=\"num-item\">\n\t\t\t\t\t<h2>{{ userInfo.eventCount }}</h2>\n\t\t\t\t\t<div>动态</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"num-item\" @click=\"toFollows\">\n\t\t\t\t\t<h2>{{ userInfo.follows }}</h2>\n\t\t\t\t\t<div>关注</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"num-item\" @click=\"toFansList\">\n\t\t\t\t\t<h2>{{ userInfo.followeds | formatNum }}</h2>\n\t\t\t\t\t<div>粉丝</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div style=\"text-align: center\">\n\t\t\t\t<el-button round size=\"small\">签到</el-button>\n\t\t\t</div>\n\t\t\t<ul class=\"userinfo-list\">\n\t\t\t\t<li @click=\"toMyhome\">\n\t\t\t\t\t<span><i class=\"iconfont icon-user\"></i>个人主页</span><i class=\"iconfont icon-xiayiye\"></i>\n\t\t\t\t</li>\n\t\t\t\t<li @click=\"getUserRecordBy\">\n\t\t\t\t\t<span><i class=\"iconfont icon-dengji\"></i>听歌排行</span><i class=\"iconfont icon-xiayiye\"></i>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<span><i class=\"iconfont icon-shezhi\"></i>个人设置</span><i class=\"iconfont icon-xiayiye\"></i>\n\t\t\t\t</li>\n\t\t\t\t<li @click=\"logout\">\n\t\t\t\t\t<span><i class=\"iconfont icon-tuichu\"></i>退出登录</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { logout } from \"../../../../network/login/login\";\nimport { getUserDetail } from \"../../../../network/userdetail/userdetail\";\nimport { mapGetters } from \"vuex\";\nexport default {\n\tname: \"UserPop\",\n\tcomputed: {\n\t\t...mapGetters([\"userInfo\"]),\n\t},\n\tcreated() {\n\t\tthis.getUserDetailBy();\n\t},\n\tmethods: {\n\t\t//获取用户个人信息\n\t\tgetUserDetailBy() {\n\t\t\tgetUserDetail(this.userInfo.userId).then(res => {\n\t\t\t\tthis.setItem(\"userInfo\", res.data.profile);\n\t\t\t\t// 提交vuex 保存用户信息\n\t\t\t\tthis.$store.dispatch(\"saveUserInfo\", res.data.profile);\n\t\t\t});\n\t\t},\n\t\t// 点击个人主页\n\t\ttoMyhome() {\n\t\t\tthis.$router.push(\"/userdetail/\" + this.userInfo.userId);\n\t\t},\n\t\t// 点击听歌排行去往用户播放记录页面\n\t\tgetUserRecordBy() {\n\t\t\tthis.$router.push(\"/userdetail/record/\" + this.userInfo.userId);\n\t\t},\n\t\t//点击关注去往关注列表\n\t\ttoFollows() {\n\t\t\tthis.$router.push({\n\t\t\t\tname: \"Follows\",\n\t\t\t\tparams: {\n\t\t\t\t\tuid: this.userInfo.userId,\n\t\t\t\t\tuname: this.userInfo.nickname,\n\t\t\t\t\tfollows: this.userInfo.follows,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\t//点击粉丝去往粉丝列表\n\t\ttoFansList() {\n\t\t\tthis.$router.push({\n\t\t\t\tname: \"FansList\",\n\t\t\t\tparams: { uid: this.userInfo.userId, uname: this.userInfo.nickname },\n\t\t\t});\n\t\t},\n\n\t\t// 退出登录\n\t\tlogout() {\n\t\t\tthis.$confirm(\"您确定退出登录吗?\", \"提示\", {\n\t\t\t\tconfirmButtonText: \"确定\",\n\t\t\t\tcancelButtonText: \"取消\",\n\t\t\t\ttype: \"warning\",\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tlogout().then(res => {\n\t\t\t\t\t\tthis.$message({\n\t\t\t\t\t\t\tshowClose: true,\n\t\t\t\t\t\t\tmessage: \"退出成功\",\n\t\t\t\t\t\t\ttype: \"success\",\n\t\t\t\t\t\t\tcenter: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// 更新登录状态\n\t\t\t\t\t\tthis.$store.dispatch(\"updateLogin\", false);\n\t\t\t\t\t\tthis.removeItem(\"isLogin\");\n\t\t\t\t\t\t// 清空用户信息\n\t\t\t\t\t\tthis.$store.dispatch(\"saveUserInfo\", null);\n\t\t\t\t\t\tthis.removeItem(\"userInfo\");\n\t\t\t\t\t\t// 清空歌单\n\t\t\t\t\t\tthis.$store.dispatch(\"saveUserSongList\", []);\n\t\t\t\t\t\tthis.removeItem(\"userSongList\");\n\t\t\t\t\t\t// 清空用户喜欢的音乐id列表\n\t\t\t\t\t\tthis.$store.dispatch(\"saveLikeSongIds\", []);\n\t\t\t\t\t\tthis.removeItem(\"likeSongIds\");\n                        console.log(res)\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\terr;\n\t\t\t\t});\n\t\t},\n\t},\n\tmounted() {\n\t\t// 点击其他区域关闭弹框\n\t\tdocument.addEventListener(\"mouseup\", e => {\n\t\t\tlet showuserpop = document.querySelector(\"#showuserpop\");\n\t\t\tif (showuserpop) {\n\t\t\t\tif (!showuserpop.contains(e.target)) {\n\t\t\t\t\tthis.$emit(\"closeuserPop\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n};\n</script>\n\n<style lang=\"less\" scoped>\n.user-pop {\n\tposition: absolute;\n\ttop: 62px;\n\tright: 45px;\n\tbox-shadow: 0px 0px 2px 2px #eef;\n\tbackground: #fff;\n\tborder-radius: 5px;\n\t.data-num {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tmargin: 10px 0;\n\t\t.num-item {\n\t\t\tpadding: 0 15px;\n\t\t\ttext-align: center;\n\t\t\tcursor: pointer;\n\t\t}\n\t}\n\t.userinfo-list {\n\t\tmargin: 5px 0;\n\t\tli {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t\tpadding: 5px 5px;\n\t\t\t&:hover {\n\t\t\t\tbackground: #eee;\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t}\n\t}\n}\n.user-pop ::after {\n\tposition: absolute;\n\ttop: -30px;\n\tleft: 85px;\n\tcontent: \"\";\n\twidth: 0;\n\theight: 0;\n\tborder: 15px solid;\n\tborder-left-color: transparent;\n\tborder-top-color: transparent;\n\tborder-right-color: transparent;\n\tborder-bottom-color: #fff;\n}\n</style>\n"],"mappings":";AAuCA,SAAAA,MAAA;AACA,SAAAC,aAAA;AACA,SAAAC,UAAA;AACA;EACAC,IAAA;EACAC,QAAA;IACA,GAAAF,UAAA;EACA;EACAG,QAAA;IACA,KAAAC,eAAA;EACA;EACAC,OAAA;IACA;IACAD,gBAAA;MACAL,aAAA,MAAAO,QAAA,CAAAC,MAAA,EAAAC,IAAA,CAAAC,GAAA;QACA,KAAAC,OAAA,aAAAD,GAAA,CAAAE,IAAA,CAAAC,OAAA;QACA;QACA,KAAAC,MAAA,CAAAC,QAAA,iBAAAL,GAAA,CAAAE,IAAA,CAAAC,OAAA;MACA;IACA;IACA;IACAG,SAAA;MACA,KAAAC,OAAA,CAAAC,IAAA,uBAAAX,QAAA,CAAAC,MAAA;IACA;IACA;IACAW,gBAAA;MACA,KAAAF,OAAA,CAAAC,IAAA,8BAAAX,QAAA,CAAAC,MAAA;IACA;IACA;IACAY,UAAA;MACA,KAAAH,OAAA,CAAAC,IAAA;QACAhB,IAAA;QACAmB,MAAA;UACAC,GAAA,OAAAf,QAAA,CAAAC,MAAA;UACAe,KAAA,OAAAhB,QAAA,CAAAiB,QAAA;UACAC,OAAA,OAAAlB,QAAA,CAAAkB;QACA;MACA;IACA;IACA;IACAC,WAAA;MACA,KAAAT,OAAA,CAAAC,IAAA;QACAhB,IAAA;QACAmB,MAAA;UAAAC,GAAA,OAAAf,QAAA,CAAAC,MAAA;UAAAe,KAAA,OAAAhB,QAAA,CAAAiB;QAAA;MACA;IACA;IAEA;IACAzB,OAAA;MACA,KAAA4B,QAAA;QACAC,iBAAA;QACAC,gBAAA;QACAC,IAAA;MACA,GACArB,IAAA;QACAV,MAAA,GAAAU,IAAA,CAAAC,GAAA;UACA,KAAAqB,QAAA;YACAC,SAAA;YACAC,OAAA;YACAH,IAAA;YACAI,MAAA;UACA;UACA;UACA,KAAApB,MAAA,CAAAC,QAAA;UACA,KAAAoB,UAAA;UACA;UACA,KAAArB,MAAA,CAAAC,QAAA;UACA,KAAAoB,UAAA;UACA;UACA,KAAArB,MAAA,CAAAC,QAAA;UACA,KAAAoB,UAAA;UACA;UACA,KAAArB,MAAA,CAAAC,QAAA;UACA,KAAAoB,UAAA;UACAC,OAAA,CAAAC,GAAA,CAAA3B,GAAA;QACA;MACA,GACA4B,KAAA,CAAAC,GAAA;QACAA,GAAA;MACA;IACA;EACA;EACAC,QAAA;IACA;IACAC,QAAA,CAAAC,gBAAA,YAAAC,CAAA;MACA,IAAAC,WAAA,GAAAH,QAAA,CAAAI,aAAA;MACA,IAAAD,WAAA;QACA,KAAAA,WAAA,CAAAE,QAAA,CAAAH,CAAA,CAAAI,MAAA;UACA,KAAAC,KAAA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}